---
title: "InitialDataExploration"
author: "Kathleen Mason"
date: "10/6/2020"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Setup and Upload}
library(tidyverse)
library(ggridges)

install.packages('patchwork')
library(patchwork)


getwd()


Up1_processed<-read_csv("./Processed/Up1_processed.csv")
Up2_processed<-read_csv("./Processed/Up2_processed.csv")
Imp1_processed<-read_csv("./Processed/Imp1_processed.csv")
Imp2_processed<-read_csv("./Processed/Imp2_processed.csv")
Down1_processed<-read_csv("./Processed/Down1_processed.csv")
Down2A_processed<-read_csv("./Processed/Down2A_processed.csv")
Down2B_processed<-read_csv("./Processed/Down2B_processed.csv")

class(Up1_processed$Date)
```

```{r Initial Graphs}

#Rename the DO
colnames(Up1_processed)[4] <- "Dissolved Oxygen"
summary(Up1_processed$`Dissolved Oxygen`)
colnames(Imp1_processed)[5] <- "Dissolved Oxygen"
summary(Imp1_processed$`Dissolved Oxygen`)

colnames(Up2_processed)[4]<-"Dissolved Oxygen"
colnames(Imp2_processed)[6]<-"Dissolved Oxygen"

colnames(Down1_processed)[6]<-"Dissolved Oxygen"
colnames(Down2A_processed)[4]<-"Dissolved Oxygen"
colnames(Down2B_processed)[4]<-"Dissolved Oxygen"


#Average DO per day since sampled multiple times a day
Up1AvgDO<-  Up1_processed %>%
  group_by(Date) %>%
  summarise(AvgDO = mean(`Dissolved Oxygen`))
Imp1AvgDO<-  Imp1_processed %>%
  group_by(Date) %>%
  summarise(AvgDO = mean(`Dissolved Oxygen`))
Up2AvgDO<-  Up2_processed %>%
  group_by(Date) %>%
  summarise(AvgDO = mean(`Dissolved Oxygen`))
Imp2AvgDO<-  Imp2_processed %>%
  group_by(Date) %>%
  summarise(AvgDO = mean(`Dissolved Oxygen`))
Down1AvgDO<-  Down1_processed %>%
  group_by(Date) %>%
  summarise(AvgDO = mean(`Dissolved Oxygen`))
Down2AAvgDO<-  Down2A_processed %>%
  group_by(Date) %>%
  summarise(AvgDO = mean(`Dissolved Oxygen`))
Down2BAvgDO<-  Down2B_processed %>%
  group_by(Date) %>%
  summarise(AvgDO = mean(`Dissolved Oxygen`))



#Graph

Up1plot <-ggplot(Up1AvgDO, aes(x = Date, y = AvgDO)) +
geom_point(size=.75, color="royalblue4")  + ylim(0, 15) +ylab("Avg Daily DO (mgL)")+ xlab("Sampling Date")+scale_x_date(date_breaks = "1 year", date_labels = "%Y")+
  labs(title = "Upstream 1")+
  theme(panel.background = element_rect(fill = "grey97"),
        panel.grid.major = element_line(color = "gray68", size = 0.5),
        panel.grid.minor = element_line(color = "gray80", size = 0.25))

Up1plot

Imp1plot<- ggplot(Imp1AvgDO, aes(x = Date, y = AvgDO)) +
geom_point(size=.75, color="royalblue4")  +ylim(0, 15) +ylab("Avg Daily DO (mgL)")+ xlab("Sampling Date")+scale_x_date(date_breaks = "1 year", date_labels = "%Y")+
  labs(title = "Impoundment 1")+
  theme(panel.background = element_rect(fill = "grey97"),
        panel.grid.major = element_line(color = "gray68", size = 0.5),
        panel.grid.minor = element_line(color = "gray80", size = 0.25))

Imp1plot

Up2plot<- ggplot(Up2AvgDO, aes(x = Date, y = AvgDO)) +
geom_point(size=.75, color="royalblue4") +ylim(0, 15) +ylab("Avg Daily DO (mgL)") + xlab("Sampling Date")+scale_x_date(date_breaks = "1 year", date_labels = "%Y")+
   labs(title = "Upstream 2")+
  theme(panel.background = element_rect(fill = "grey97"),
        panel.grid.major = element_line(color = "gray68", size = 0.5),
        panel.grid.minor = element_line(color = "gray80", size = 0.25))

Up2plot

Imp2plot<- ggplot(Imp2AvgDO, aes(x = Date, y = AvgDO)) +
geom_point(size=.75, color="royalblue4")+ylab("Avg Daily DO (mgL)")
summary(Up2_processed$`Dissolved Oxygen`) #No DO data actually exists for Imp2

Down1plot<- ggplot(Down1AvgDO, aes(x = Date, y = AvgDO)) +
geom_point(size=.75, color="royalblue4")+ ylim(0, 15)+ylab("Avg Daily DO (mgL)")+ xlab("Sampling Date")+ scale_x_date(date_breaks = "1 year", date_labels = "%Y")+
   labs(title = "Downstream 1")+
  theme(panel.background = element_rect(fill = "grey97"),
        panel.grid.major = element_line(color = "gray68", size = 0.5),
        panel.grid.minor = element_line(color = "gray80", size = 0.25))
summary(Down1AvgDO) #655 missing values

Down1plot

Down2Aplot<- ggplot(Down2AAvgDO, aes(x = Date, y = AvgDO)) +
geom_point(size=.75, color="royalblue4")+ylim(0, 15) +ylab("Avg Daily DO (mgL)")+ xlab("Sampling Date")+scale_x_date(date_breaks = "1 year", date_labels = "%Y")+
   labs(title = "Downstream 2A")+
  theme(panel.background = element_rect(fill = "grey97"),
        panel.grid.major = element_line(color = "gray68", size = 0.5),
        panel.grid.minor = element_line(color = "gray80", size = 0.25))

Down2Aplot

Down2Bplot<- ggplot(Down2BAvgDO, aes(x = Date, y = AvgDO)) +
geom_point(size=.75, color="royalblue4")+ ylim(0,15)+ylab("Avg Daily DO (mgL)")+ xlab("Sampling Date")+
  scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
  labs(title = "Downstream 2B")+
  theme(panel.background = element_rect(fill = "grey97"),
        panel.grid.major = element_line(color = "gray68", size = 0.5),
        panel.grid.minor = element_line(color = "gray80", size = 0.25))
Down2Bplot

AllUp<- Up1plot+Up2plot
AllUp


AllDown<-Down1plot+Down2Aplot+Down2Bplot

AllDown

Imp1plot


#Trying to add in line where dam was removed
#+abline(v=as.Date("2017-09-21","%Y-%m-%d"))
#+ abline(v=as.Date("2017-09-21"))
#+geom_text(y = as.Date("2020-01-01"), y = 120, label = "unhealthy (sensitive groups)", hjust = 1, fontface
#these are not working

summary(Down2BAvgDO)
```


